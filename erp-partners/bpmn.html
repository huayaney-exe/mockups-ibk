<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagrama de Secuencia - Flujo Operacional H2H Shinkansen</title>
    <link href="https://fonts.googleapis.com/css2?family=Geometria:wght@400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        :root {
            --primaryGreen1: #05be50;
            --primaryGreenDark: #049543;
            --secondaryBlue1: #0039A6;
            --extendedBeige1: #F0F0DC;
            --extendedRed1: #E74C3C;
            --grayBlack: #0F191E;
            --grayText: #333333;
            --grayMedium: #666666;
            --grayBackground: #F8F9FA;
            --white: #FFFFFF;
            --shadow-lg: 0 8px 16px rgba(15, 25, 30, 0.2);
            --transition-normal: 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, var(--grayBackground) 0%, var(--extendedBeige1) 100%);
            color: var(--grayText);
            line-height: 1.6;
            padding: 40px 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            padding: 60px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--primaryGreen1);
        }

        .ibk-logo {
            font-family: 'Geometria', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primaryGreen1);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--primaryGreen1);
            color: var(--white);
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            transition: var(--transition-normal);
        }

        .back-link:hover {
            background: var(--primaryGreenDark);
            transform: translateY(-2px);
        }

        h1 {
            font-family: 'Geometria', sans-serif;
            font-size: 3rem;
            font-weight: 700;
            color: var(--grayBlack);
            margin-bottom: 20px;
        }

        .highlight {
            color: var(--primaryGreen1);
        }

        .subtitle {
            font-size: 1.3rem;
            color: var(--grayMedium);
            margin-bottom: 40px;
            font-weight: 500;
        }

        .diagram-container {
            background: var(--white);
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
            overflow-x: auto;
        }

        .footer-note {
            background: var(--grayBackground);
            padding: 25px;
            border-radius: 8px;
            border-left: 5px solid var(--primaryGreen1);
            margin-top: 30px;
        }

        .footer-note h3 {
            font-family: 'Geometria', sans-serif;
            color: var(--grayBlack);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .footer-note p {
            color: var(--grayMedium);
            margin-bottom: 10px;
            line-height: 1.8;
        }

        .footer-note strong {
            color: var(--extendedRed1);
        }

        @media (max-width: 1200px) {
            .container {
                padding: 40px;
            }

            h1 {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 20px 10px;
            }

            .container {
                padding: 30px 20px;
            }

            .header {
                flex-direction: column;
                gap: 20px;
            }

            .ibk-logo {
                font-size: 1.8rem;
            }

            h1 {
                font-size: 2rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="ibk-logo">Interbank</div>
            <a href="/erp-partners" class="back-link">
                ← Volver a Presentación
            </a>
        </div>

        <h1>Diagrama de Secuencia <span class="highlight">Operacional</span></h1>
        <p class="subtitle">Flujo completo del proceso H2H con Shinkansen</p>

        <div class="diagram-container">
            <pre class="mermaid">
sequenceDiagram
    participant Cliente as Cliente Empresarial
    participant InterbankComercial as Interbank Comercial
    participant Shinkansen as Shinkansen
    participant InterbankSFTP as Interbank SFTP
    participant InterbankH2H as Interbank H2H
    participant InterbankContabilidad as Interbank Contabilidad

    Note over Cliente: Identifica necesidad<br/>de automatización H2H

    Cliente->>InterbankComercial: Contacta para implementar H2H
    InterbankComercial->>InterbankComercial: Evalúa capacidad técnica del cliente

    Note over InterbankComercial: Detecta gap técnico:<br/>Cliente carece de equipo IT

    InterbankComercial->>Shinkansen: Referencia cliente vía email

    Shinkansen->>Cliente: Contacta y evalúa ERP/sistema
    Shinkansen->>Shinkansen: Desarrolla código de integración personalizado
    Shinkansen->>Cliente: Instala código en sistema del cliente
    Shinkansen->>Shinkansen: Configura SFTP

    Shinkansen->>InterbankComercial: Solicita provisión de credenciales
    InterbankComercial->>InterbankSFTP: Crea credenciales SFTP para cliente
    InterbankComercial->>Shinkansen: Entrega credenciales
    Shinkansen->>Cliente: Configura credenciales en sistema

    Note over Cliente,InterbankSFTP: ✅ Conexión establecida<br/>(1-2 semanas)

    loop Procesamiento de pagos diario
        Cliente->>InterbankSFTP: Envía archivo de pagos (SFTP)
        InterbankSFTP->>InterbankH2H: Transfiere archivo para procesamiento
        InterbankH2H->>InterbankH2H: Valida y procesa archivo
        InterbankH2H->>InterbankSFTP: Genera archivo de confirmación
        InterbankSFTP->>Cliente: Entrega confirmación

        Note over Cliente,InterbankH2H: COMISIÓN POR TRANSACCIÓN:<br/>OPCIÓN A: Interbank cobra directamente al cliente (requiere desarrollo)<br/>OPCIÓN B: Shinkansen cobra al cliente (sin desarrollo)

        alt OPCIÓN A: Interbank cobra directo
            InterbankH2H->>Cliente: Cobra comisión por transacción
        else OPCIÓN B: Shinkansen cobra y paga
            Shinkansen->>Cliente: Cobra comisión por transacción
            Shinkansen->>Shinkansen: Acumula conteo para facturar a Interbank
        end
    end

    Note over Shinkansen: OPCIÓN B - Fin de mes:<br/>Calcula 50% del volumen total cobrado al cliente

    loop Facturación mensual (solo OPCIÓN B)
        Shinkansen->>InterbankContabilidad: Envía factura mensual (50% de comisiones cobradas)

        Note over InterbankContabilidad: ⚠️ PROCESO MANUAL

        InterbankContabilidad->>InterbankContabilidad: Recibe factura de Shinkansen
        InterbankContabilidad->>InterbankH2H: Solicita reporte de transacciones mensuales
        InterbankH2H->>InterbankContabilidad: Entrega reporte de volumen
        InterbankContabilidad->>InterbankContabilidad: Calcula: 50% del volumen × tarifa cliente
        InterbankContabilidad->>InterbankContabilidad: Verifica que factura coincida con cálculo

        alt Monto coincide
            InterbankContabilidad->>InterbankContabilidad: Genera comprobante contable manual
            InterbankContabilidad->>Shinkansen: Procesa pago a mes siguiente
            Note over InterbankContabilidad: ❌ PAIN POINT:<br/>Generación manual de comprobantes<br/>(2-4 horas/mes)
        else Monto no coincide
            InterbankContabilidad->>Shinkansen: Solicita aclaración de discrepancia
            InterbankContabilidad->>InterbankContabilidad: Ajusta y genera comprobante
        end

        InterbankContabilidad->>InterbankContabilidad: Archiva documentación soporte
    end
            </pre>
        </div>

        <div class="footer-note">
            <h3>Modelo Financiero</h3>
            <p><strong>Cliente</strong> paga: <strong>Tarifa mensual H2H</strong> (servicio fijo mensual a Shinkansen)</p>

            <p style="margin-top: 15px;"><strong>Comisión por transacción</strong> (dos opciones):</p>

            <div style="margin-left: 25px; margin-top: 10px;">
                <p><strong>OPCIÓN A</strong> (requiere desarrollo):</p>
                <ul style="margin-left: 20px; line-height: 1.8;">
                    <li>Interbank cobra comisión <strong>directamente al cliente</strong> por cada transacción</li>
                    <li>Shinkansen NO cobra comisión por transacciones</li>
                    <li>Shinkansen NO factura a Interbank</li>
                </ul>

                <p style="margin-top: 15px;"><strong>OPCIÓN B</strong> (sin desarrollo, implementada actualmente):</p>
                <ul style="margin-left: 20px; line-height: 1.8;">
                    <li>Shinkansen cobra comisión <strong>directamente al cliente</strong> por cada transacción (rango: 1.00 - 2.00 soles)</li>
                    <li>Shinkansen acumula el conteo mensual de transacciones</li>
                    <li>Fin de mes: Shinkansen factura a Interbank el <strong>50% del volumen total cobrado</strong> (mínimo: 0.50 soles/transacción)</li>
                    <li>Interbank procesa pago a Shinkansen al mes siguiente</li>
                    <li>Shinkansen retiene el otro 50% como su margen operativo</li>
                </ul>
            </div>

            <p style="margin-top: 15px; color: #666; font-size: 14px;"><em>Nota técnica: BCP otorga a Shinkansen un margen de 0.45 soles por transacción (dato referencial de mercado)</em></p>

            <h3 style="margin-top: 25px;">Análisis de Costos Operacionales H2H</h3>
            <p><strong>Costo promedio por transacción H2H para Interbank</strong> (datos históricos 2025):</p>

            <table style="width: 100%; margin-top: 15px; border-collapse: collapse; font-size: 14px;">
                <thead>
                    <tr style="background: var(--primaryGreen1); color: white;">
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Periodo</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Ene 2025</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Feb 2025</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Mar 2025</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Abr 2025</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">May 2025</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Jun 2025</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Jul 2025</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Ago 2025</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Sep 2025</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Oct 2025</th>
                        <th style="padding: 10px; text-align: center; border: 1px solid #ddd; background: var(--primaryGreenDark);">Promedio</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd; font-weight: 600;">Costo (S/)</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.70</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd; background: #e8f5e9;">0.50</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd; background: #e8f5e9;">0.50</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.60</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd; background: #fff9c4;">0.40</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd; background: #e8f5e9;">0.50</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.60</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.70</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.60</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.60</td>
                        <td style="padding: 10px; text-align: center; border: 1px solid #ddd; font-weight: 700; background: #c8e6c9;">0.57</td>
                    </tr>
                </tbody>
            </table>

            <div style="margin-top: 15px; padding: 15px; background: #fff9c4; border-left: 4px solid #fbc02d; border-radius: 4px;">
                <p style="margin: 0; color: #333;"><strong>📊 Insight clave:</strong> El costo operacional varía entre <strong>0.40 - 0.70 soles</strong> por transacción, con un <strong>piso técnico de 0.50 soles</strong> (costo mínimo sostenible).</p>
            </div>

            <h3 style="margin-top: 25px;">Propuesta de Pricing Interbank</h3>
            <div style="margin-left: 25px;">
                <p><strong>Modelo de Revenue Share 50/50:</strong></p>
                <ul style="margin-left: 20px; line-height: 1.8; margin-top: 10px;">
                    <li><strong>Shinkansen cobra al cliente:</strong> Entre 1.00 - 2.00 soles por transacción (rango flexible según cliente)</li>
                    <li><strong>Interbank recibe:</strong> 50% de lo cobrado (mínimo garantizado: 0.50 soles)</li>
                    <li><strong>Shinkansen retiene:</strong> 50% de lo cobrado como su margen</li>
                    <li><strong>Proceso:</strong> Shinkansen cobra todo al cliente → factura a Interbank mensualmente → Interbank paga 50% del volumen total</li>
                </ul>

                <div style="margin-top: 15px; padding: 15px; background: #e8f5e9; border-left: 4px solid var(--primaryGreen1); border-radius: 4px;">
                    <p style="margin: 0; color: #333;"><strong>✅ Ventaja del modelo:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 8px; line-height: 1.6;">
                        <li>Cubre costo operacional mínimo (0.50 soles) garantizando rentabilidad</li>
                        <li>Margen promedio esperado: 0.07 - 0.10 soles por transacción (12-20%)</li>
                        <li>Flexibilidad comercial para Shinkansen según perfil del cliente</li>
                        <li>Alineación de incentivos: a mayor volumen, mayor ingreso para ambos</li>
                    </ul>
                </div>

                <p style="margin-top: 15px;"><strong>Ejemplo de cálculo:</strong></p>
                <table style="width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 14px;">
                    <thead>
                        <tr style="background: var(--secondaryBlue1); color: white;">
                            <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">Concepto</th>
                            <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Tarifa 1.00 S/</th>
                            <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Tarifa 1.50 S/</th>
                            <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Tarifa 2.00 S/</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd;">Shinkansen cobra al cliente</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1.00</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1.50</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">2.00</td>
                        </tr>
                        <tr style="background: #f5f5f5;">
                            <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Interbank recibe (50%)</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd; font-weight: 600;">0.50</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd; font-weight: 600;">0.75</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd; font-weight: 600;">1.00</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd;">Costo operacional promedio</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.57</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.57</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.57</td>
                        </tr>
                        <tr style="background: #ffebee;">
                            <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Margen Interbank</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd; font-weight: 600; color: var(--extendedRed1);">-0.07</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd; font-weight: 600; background: #c8e6c9;">+0.18</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd; font-weight: 600; background: #c8e6c9;">+0.43</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd;">Shinkansen retiene (50%)</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.50</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">0.75</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1.00</td>
                        </tr>
                    </tbody>
                </table>

                <p style="margin-top: 10px; color: #666; font-size: 13px;"><em>Nota: Tarifa mínima recomendada de 1.20 S/ para garantizar rentabilidad en ambos lados. Tarifa de 1.00 S/ no cubre costos promedio de Interbank.</em></p>
            </div>

            <h3 style="margin-top: 25px;">Pain Point Crítico Identificado</h3>
            <p><strong>Generación manual de comprobantes contables mensuales</strong></p>
            <p>El equipo de contabilidad debe:</p>
            <ul style="margin-left: 25px; margin-top: 10px; line-height: 2;">
                <li>Recibir factura mensual de Shinkansen (50% de comisiones cobradas)</li>
                <li>Solicitar manualmente reporte de transacciones a Operaciones</li>
                <li>Calcular monto esperado (50% del volumen × tarifa cliente)</li>
                <li>Verificar que factura coincida con cálculo</li>
                <li>Generar comprobante contable en sistema</li>
                <li>Procesar pago al mes siguiente</li>
                <li>Archivar documentación de soporte</li>
            </ul>
            <p style="margin-top: 15px;"><strong>Tiempo:</strong> 2-4 horas por mes por partner</p>
            <p><strong>Riesgo de escalabilidad:</strong> Con 3 partners activos en Q1 2026, el proceso manual se multiplica por 3 (6-12 horas/mes)</p>

            <h3 style="margin-top: 25px;">Nota Técnica</h3>
            <p>Shinkansen desarrolla código de integración personalizado que se instala en el sistema del cliente. El cliente se conecta <strong>directamente al SFTP de Interbank</strong> - no existe infraestructura SFTP intermedia de Shinkansen.</p>
            <p style="margin-top: 10px;"><strong>Modelo actual (pre-análisis de costos):</strong> Interbank cobraba 0.6 soles fijos por transacción a Shinkansen, quien negociaba su propio margen con el cliente final.</p>
            <p style="margin-top: 10px;"><strong>Propuesta actualizada (post-análisis):</strong> Revenue share 50/50 con tarifa flexible cliente (1.00-2.00 soles) garantizando mínimo 0.50 soles para Interbank y mejorando escalabilidad del modelo.</p>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#05be50',
                primaryTextColor: '#0F191E',
                primaryBorderColor: '#049543',
                lineColor: '#666666',
                secondaryColor: '#0039A6',
                tertiaryColor: '#F0F0DC',
                noteBkgColor: '#F0F0DC',
                noteBorderColor: '#05be50',
                noteTextColor: '#0F191E',
                actorBkg: '#0039A6',
                actorBorder: '#002F85',
                actorTextColor: '#FFFFFF',
                sequenceNumberColor: '#FFFFFF',
                signalColor: '#333333',
                signalTextColor: '#0F191E',
                labelBoxBkgColor: '#05be50',
                labelBoxBorderColor: '#049543',
                labelTextColor: '#FFFFFF',
                loopTextColor: '#0F191E',
                activationBorderColor: '#049543',
                activationBkgColor: '#66D691'
            }
        });
    </script>
</body>
</html>
